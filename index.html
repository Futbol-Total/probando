<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="icon" href="img/logo 3.png" type="image/png">
    <title>Futbol Total - Login</title>
    <link rel="stylesheet" href="estilo.css">
</head>
<body>
    <div class="main-container">
        <!-- Contenedor del formulario -->
        <div class="login-container">
            <div class="logo-container">
                <h1>FUTBOL TOTAL</h1>
                <img src="img/logo_3-removebg-preview.ico" alt="Logo Futbol Total">
            </div>
            <div class="form-container">
                <form class="login-form" id="login-form">
                    <label for="username">USUARIO</label>
                    <input type="email" id="username" placeholder="Ingresa tu usuario (email)" required>
                    
                    <label for="password">CONTRASEÑA</label>
                    <input type="password" id="password" placeholder="Ingresa tu contraseña" required>
                    
                    <div class="checkbox-container">
                        <label>
                            <input type="checkbox" id="mostrar-contrasena">
                            Mostrar contraseña
                        </label>
                        <label>
                            <input type="checkbox" id="recordar-contrasena">
                            Recordar contraseña
                        </label>
                    </div>
                    
                    <button type="submit" id="login-button">LOGIN</button>
                </form>
                <div class="extra-options">
                    <a href="#" class="forgot-password" id="forgot-password">¿Olvidaste la contraseña?</a>
                    <a href="#" class="register" id="open-register-modal">Registrarte</a>
                </div>
            </div>
        </div>

        <!-- Contenedor para opciones adicionales -->
        <div class="social-login-container">
            <h2>Iniciar Sesión con Proveedores Sociales</h2>
            <button id="login-google" class="social-login google">Iniciar sesión con Google</button>
            <button id="login-phone" class="social-login phone">Iniciar sesión con Número de Teléfono</button>
            <button id="login-facebook" class="social-login facebook">Iniciar sesión con Facebook</button>
        </div>
    </div>

    <!-- Firebase Authentication y lógica -->
    <script type="module">
      import { initializeApp } from "https://www.gstatic.com/firebasejs/10.14.0/firebase-app.js";
      import { getAuth, signInWithPopup, GoogleAuthProvider, FacebookAuthProvider, PhoneAuthProvider } from "https://www.gstatic.com/firebasejs/10.14.0/firebase-auth.js";

      const firebaseConfig = {
        apiKey: "AIzaSyDMFTlJxZdDGQ0IV0skUI6ozgPGxLYhsDg",
        authDomain: "futbol-total-b4166.firebaseapp.com",
        projectId: "futbol-total-b4166",
        storageBucket: "futbol-total-b4166.appspot.com",
        messagingSenderId: "510814548258",
        appId: "1:510814548258:web:a3c8599e36c621bdfd757b"
      };

      const app = initializeApp(firebaseConfig);
      const auth = getAuth(app);

      // Guardar los datos de usuario recibidos después del inicio de sesión social
      let socialLoginData = {
        email: null,
        password: "defaultPassword123"  // Contraseña predeterminada
      };

      // Autocompletar los campos cuando se recibe la información social
      function autofillLoginForm(email, password) {
        document.getElementById('username').value = email;
        document.getElementById('password').value = password;
      }

      // Manejo de inicio de sesión con Google
      const googleProvider = new GoogleAuthProvider();
      document.getElementById('login-google').addEventListener('click', async () => {
        try {
          const result = await signInWithPopup(auth, googleProvider);
          const user = result.user;
          socialLoginData.email = user.email;
          autofillLoginForm(socialLoginData.email, socialLoginData.password);  // Autocompletar los campos
          alert('¡Inicio de sesión con Google exitoso! Completa los datos y presiona LOGIN.');
        } catch (error) {
          console.error('Error en el inicio de sesión con Google:', error);
          alert('Error al iniciar sesión con Google: ' + error.message);
        }
      });

      // Manejo de inicio de sesión con Facebook
      const facebookProvider = new FacebookAuthProvider();
      document.getElementById('login-facebook').addEventListener('click', async () => {
        try {
          const result = await signInWithPopup(auth, facebookProvider);
          const user = result.user;
          socialLoginData.email = user.email;
          autofillLoginForm(socialLoginData.email, socialLoginData.password);  // Autocompletar los campos
          alert('¡Inicio de sesión con Facebook exitoso! Completa los datos y presiona LOGIN.');
        } catch (error) {
          console.error('Error en el inicio de sesión con Facebook:', error);
          alert('Error al iniciar sesión con Facebook: ' + error.message);
        }
      });

      // Manejo del formulario de login
      document.getElementById('login-form').addEventListener('submit', (event) => {
        event.preventDefault();

        // Verificar si los datos han sido rellenados automáticamente
        const email = document.getElementById('username').value;
        const password = document.getElementById('password').value;

        // Aquí se podría verificar si los datos coinciden con los datos sociales recibidos
        if (email === socialLoginData.email && password === socialLoginData.password) {
          alert('¡Autenticación completa! Redirigiendo a la página principal...');
          window.location.href = "pantalla de carga.html";  // Redirigir al dashboard u otra página
        } else {
          alert('Los datos no coinciden con los recibidos del proveedor social.');
        }
      });
    </script>
</body>
</html>
